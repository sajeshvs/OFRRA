<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Furnished Room Rental Agreement</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --glass-bg: rgba(255, 255, 255, 0.9);
            --glass-bg-light: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.3);
            --shadow-light: 0 4px 16px 0 rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 8px 32px 0 rgba(0, 0, 0, 0.12);
            --shadow-heavy: 0 16px 48px 0 rgba(0, 0, 0, 0.15);
            --border-radius: 16px;
            --border-radius-lg: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            position: relative;
        }
        
        /* Remove grain overlay that's causing readability issues */
        .form-section {
            scroll-margin-top: 80px;
        }
        
        .required-marker::after {
            content: '*';
            color: #EF4444;
            margin-left: 4px;
            font-weight: 700;
        }
        
        .rule-checkbox:checked + label {
            text-decoration: line-through;
            color: #6B7280;
            opacity: 0.8;
            transform: scale(0.98);
            transition: var(--transition);
        }
        
        /* Modern Glassmorphism Cards - Improved readability */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
        }
        
        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        /* Enhanced Form Input Styling - Better contrast */
        input, select {
            border: 2px solid rgba(99, 102, 241, 0.2);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(8px);
            border-radius: 12px;
            padding: 16px 18px;
            font-size: 15px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
            color: #1F2937;
            width: 100%;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15), var(--shadow-medium);
            transform: translateY(-1px);
            background: rgba(255, 255, 255, 1);
        }
        
        input:invalid {
            border-color: #EF4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
        }
        
        /* Readonly field styling */
        input[readonly] {
            background: rgba(249, 250, 251, 0.95);
            border-color: rgba(209, 213, 219, 0.8);
            color: #4B5563;
            cursor: not-allowed;
        }
        
        input[readonly]:focus {
            box-shadow: var(--shadow-light);
            border-color: rgba(209, 213, 219, 0.8);
            transform: none;
        }
        
        /* Modern Labels - Better contrast */
        label {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 8px;
            display: block;
            font-size: 15px;
            letter-spacing: -0.01em;
        }
        
        
        /* Modern Button Styling */
        .btn-generate {
            background: var(--primary-gradient);
            border: none;
            border-radius: var(--border-radius);
            padding: 16px 32px;
            font-weight: 700;
            font-size: 16px;
            letter-spacing: -0.01em;
            color: white;
            position: relative;
            overflow: hidden;
            transition: var(--transition);
            box-shadow: var(--shadow-medium);
        }
        
        .btn-generate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-generate:hover::before {
            left: 100%;
        }
        
        .btn-generate:enabled:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }
        
        .btn-generate:enabled:active {
            transform: translateY(-1px) scale(1.01);
        }
        
        .btn-generate:disabled {
            background: linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%);
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* Modern Checkboxes */
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            border-radius: 6px;
            border: 2px solid #D1D5DB;
            background: white;
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }
        
        input[type="checkbox"]:checked {
            background: var(--primary-gradient);
            border-color: #667eea;
            transform: scale(1.1);
        }
        
        input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        
        /* Preview Panel Enhancements */
        .preview-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            overflow: hidden;
        }
        
        .preview-panel:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Modern Section Headers - Improved readability */
        .section-header {
            background: var(--glass-bg-light);
            backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 24px 28px;
            margin-bottom: 28px;
            box-shadow: var(--shadow-light);
        }
        
        .section-title {
            font-size: 22px;
            font-weight: 700;
            color: #1F2937;
            margin: 0;
            letter-spacing: -0.02em;
        }
        
        /* Card Components - Better contrast */
        .info-card {
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--border-radius);
            padding: 24px;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }
        
        .info-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-medium);
            border-color: rgba(255, 255, 255, 0.6);
        }
        
        /* Grid Layout Improvements - Better alignment */
        .modern-grid {
            display: grid;
            gap: 24px;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            align-items: start;
        }
        
        /* Fix for checkbox layout alignment */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            align-items: stretch;
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            padding: 16px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            min-height: 60px;
        }
        
        .checkbox-item:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateY(-1px);
            box-shadow: var(--shadow-light);
        }
        
        /* Progress Bar Modern Design */
        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            overflow: hidden;
            height: 8px;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 12px;
            background: var(--success-gradient);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        
        /* Enhanced Animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
        }
        
        @keyframes bounceIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .animate-slide-in {
            animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        .status-check {
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* Modern Typography - Better readability */
        .text-gradient {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            text-shadow: none;
        }
        
        .text-shadow {
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .text-white-shadow {
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        /* Status Indicators - Better visibility */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .status-pending {
            color: #D97706;
            border-color: rgba(251, 191, 36, 0.3);
        }
        
        .status-complete {
            color: #059669;
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        /* Modern Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        /* Notification Enhancements */
        .notification {
            backdrop-filter: blur(16px);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-medium);
        }
        
        /* Grid Layout Improvements */
        .modern-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
        
        /* Floating Elements */
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* Print Styles */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            body * {
                visibility: hidden;
            }
            #print-output, #print-output * {
                visibility: visible;
            }
            #print-output {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                font-size: 10pt;
                color: #1F2937 !important;
                line-height: 1.4;
                background: white !important;
            }
            .no-print {
                display: none !important;
            }
            @page {
                margin: 0.75in;
                size: A4;
            }
            /* Page break controls */
            .page-break-before {
                page-break-before: always;
            }
            .page-break-after {
                page-break-after: always;
            }
            .page-break-inside-avoid {
                page-break-inside: avoid;
            }
            .keep-together {
                page-break-inside: avoid;
                break-inside: avoid;
            }
            /* Ensure gradients and colors print */
            .print-gradient {
                background: #667EEA !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .print-card {
                box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
                border: 1px solid #E5E7EB !important;
            }
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 relative">
        <!-- Modern Header with Better Readability -->
        <div class="text-center mb-12 no-print">
            <div class="glass-card p-10 mb-8">
                <h1 class="text-4xl lg:text-5xl font-bold text-gradient mb-6">
                    Online Furnished Room Rental Agreement
                </h1>
                <p class="text-xl text-gray-700 font-medium leading-relaxed max-w-3xl mx-auto mb-8">
                    Create your professional rental agreement with our modern, intuitive platform designed for
                    <span class="font-bold text-indigo-700 bg-indigo-50 px-2 py-1 rounded-lg">Apartment 820, Nook 1, Jebel Ali Village, Dubai</span>
                </p>
                
                <!-- Modern Feature Pills -->
                <div class="flex flex-wrap justify-center gap-4 mt-8">
                    <span class="px-6 py-3 bg-white/90 backdrop-blur-sm rounded-full text-gray-700 text-sm font-semibold border border-gray-200 shadow-sm">
                        ‚ú® Instant PDF Generation
                    </span>
                    <span class="px-6 py-3 bg-white/90 backdrop-blur-sm rounded-full text-gray-700 text-sm font-semibold border border-gray-200 shadow-sm">
                        üè† Dubai Compliant
                    </span>
                    <span class="px-6 py-3 bg-white/90 backdrop-blur-sm rounded-full text-gray-700 text-sm font-semibold border border-gray-200 shadow-sm">
                        üì± Mobile Friendly
                    </span>
                </div>
            </div>
            
            <!-- Notification Area -->
            <div id="notification" class="hidden notification p-4 rounded-lg animate-fade-in">
                <p id="notification-text"></p>
            </div>
        </div>

        <div class="grid lg:grid-cols-5 gap-8">
            
            <!-- Modern Form Column -->
            <div class="lg:col-span-3 glass-card p-8 no-print animate-fade-in">
                <form id="rental-form" class="space-y-10">
                    
                    <!-- Section 1: Landlord Details -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">üè† Landlord Information</h2>
                        </div>
                        <div class="info-card">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="flex items-center space-x-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full flex-shrink-0"></div>
                                    <div>
                                        <p class="text-sm font-medium text-blue-600 uppercase tracking-wide">Name</p>
                                        <p class="text-lg font-bold text-gray-800">BAIJNATH JAISWAL</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4 p-4 bg-green-50 rounded-lg border border-green-200">
                                    <div class="w-3 h-3 bg-green-500 rounded-full flex-shrink-0"></div>
                                    <div>
                                        <p class="text-sm font-medium text-green-600 uppercase tracking-wide">Contact</p>
                                        <p class="text-lg font-bold text-gray-800">+971 55 177 1251</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 2: Tenant Details -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">üë§ Tenant Information</h2>
                        </div>
                        <div class="modern-grid">
                            <div class="space-y-3">
                                <label for="tenant-name" class="required-marker">Full Name</label>
                                <input type="text" id="tenant-name" placeholder="Enter your full name" required>
                            </div>
                            <div class="space-y-3">
                                <label for="tenant-id" class="required-marker">Emirates ID / Passport No.</label>
                                <input type="text" id="tenant-id" placeholder="Enter ID number" required>
                            </div>
                            <div class="space-y-3">
                                <label for="tenant-contact" class="required-marker">Contact Number</label>
                                <input type="tel" id="tenant-contact" pattern="[+]?[0-9\s\-()]+" placeholder="+971 XX XXX XXXX" title="Please enter a valid phone number" required>
                            </div>
                            <div class="space-y-3">
                                <label for="tenant-email" class="required-marker">Email Address</label>
                                <input type="email" id="tenant-email" placeholder="your.email@example.com" required>
                            </div>
                            <div class="space-y-3">
                                <label for="tenant-nationality" class="required-marker">Nationality</label>
                                <input type="text" id="tenant-nationality" placeholder="Enter nationality" required>
                            </div>
                            <div class="space-y-3">
                                <label for="tenant-visa-status" class="required-marker">Visa Status</label>
                                <select id="tenant-visa-status" required>
                                    <option value="">Select visa status</option>
                                    <option value="Employment Visa">Employment Visa</option>
                                    <option value="Student Visa">Student Visa</option>
                                    <option value="Visit Visa">Visit Visa</option>
                                    <option value="Investor Visa">Investor Visa</option>
                                    <option value="Family Visa">Family Visa</option>
                                    <option value="UAE National">UAE National</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Section 3: Property & Lease Details -->
                    <div class="form-section">
                         <div class="section-header">
                            <h2 class="section-title">üè¢ Property & Lease Details</h2>
                        </div>
                         <div class="space-y-6">
                            <!-- Property Location - Full width -->
                            <div class="space-y-3">
                                <label for="property-location">Property Location</label>
                                <input type="text" id="property-location" value="Apartment 820, Nook 1, Jebel Ali Village, Dubai" readonly>
                                <p class="text-sm text-gray-600 mt-2 flex items-center">
                                    <span class="mr-2">üìç</span>
                                    This field is pre-filled for this specific property
                                </p>
                            </div>
                            
                            <!-- Form fields grid -->
                            <div class="modern-grid">
                                <div class="space-y-3">
                                    <label for="room-type" class="required-marker">Room Type</label>
                                    <select id="room-type" required>
                                        <option value="">Select room type</option>
                                        <option value="Room with Attached Toilet">üöø Room with Attached Toilet</option>
                                        <option value="Room without Attached Toilet">üè† Room without Attached Toilet (Shared Bathroom)</option>
                                    </select>
                                </div>
                                <div class="space-y-3">
                                    <label for="contract-start-date" class="required-marker">Contract Start Date</label>
                                    <input type="date" id="contract-start-date" required>
                                </div>
                                <div class="space-y-3">
                                    <label for="monthly-rent" class="required-marker">Monthly Rent (AED)</label>
                                    <input type="number" id="monthly-rent" value="3200" min="1000" max="50000" step="100" placeholder="3,200" required>
                                </div>
                                <div class="space-y-3">
                                    <label for="security-deposit" class="required-marker">Security Deposit (AED)</label>
                                    <input type="number" id="security-deposit" value="3200" min="1000" max="50000" step="100" placeholder="3,200" required>
                                </div>
                                <div class="space-y-3">
                                    <label for="additional-charges" class="required-marker">Additional Monthly Charges (AED)</label>
                                    <input type="number" id="additional-charges" value="100" min="0" max="1000" step="50" placeholder="100" required>
                                </div>
                            </div>
                            
                            <!-- Rent Inclusions -->
                            <div class="space-y-4">
                                <label class="text-lg font-semibold text-gray-700">‚ú® Rent Inclusions</label>
                                <div id="rent-inclusions" class="checkbox-grid">
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="DEWA (Electricity & Water)" checked>
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">‚ö° DEWA</span>
                                            <p class="text-xs text-gray-600 mt-1">Electricity & Water</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="High-Speed Wi-Fi Internet" checked>
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">üì∂ High-Speed Wi-Fi</span>
                                            <p class="text-xs text-gray-600 mt-1">Unlimited Internet</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="Gas" checked>
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">üî• Gas</span>
                                            <p class="text-xs text-gray-600 mt-1">Cooking Gas Supply</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="Chiller/AC" checked>
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">‚ùÑÔ∏è Chiller/AC</span>
                                            <p class="text-xs text-gray-600 mt-1">Air Conditioning</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="Furnished Room" checked>
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">üõèÔ∏è Furnished Room</span>
                                            <p class="text-xs text-gray-600 mt-1">Bed, Wardrobe, Desk</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="Cleaning Service (Common Areas)">
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">üßπ Cleaning Service</span>
                                            <p class="text-xs text-gray-600 mt-1">Common Areas Only</p>
                                        </div>
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="Clean Room Service">
                                        <div class="ml-3 flex-1">
                                            <span class="text-sm font-medium text-gray-800">‚ú® Room Cleaning</span>
                                            <p class="text-xs text-gray-600 mt-1">Private Room Service</p>
                                        </div>
                                    </label>
                                </div>
                            </div>
                         </div>
                    </div>

                    <!-- Section 4: House Rules -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">üìã House Rules Acknowledgment</h2>
                        </div>
                        <div class="info-card">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                <p class="text-sm text-blue-800 font-medium flex items-center">
                                    <span class="mr-3 text-lg">üìñ</span>
                                    Please read and check each box to acknowledge your agreement to these house rules.
                                </p>
                            </div>
                            <div id="rules-list" class="space-y-4"></div>
                        </div>
                    </div>
                    
                    <!-- Section 5: Final Agreement -->
                    <div class="form-section">
                         <div class="section-header">
                            <h2 class="section-title">‚úçÔ∏è Final Declaration</h2>
                        </div>
                        <div class="info-card space-y-6">
                            <label class="checkbox-item bg-yellow-50 border-yellow-300 hover:bg-yellow-100">
                                <input id="notice-agreement" type="checkbox" required>
                                <div class="ml-3 flex-1">
                                    <span class="text-sm font-bold text-gray-800">30-Day Notice Period</span>
                                    <p class="text-sm text-gray-700 mt-1 leading-relaxed">
                                        I understand I must provide a written notice of at least 30 days before vacating, or one month's rent will be charged in lieu.
                                    </p>
                                </div>
                            </label>
                             <label class="checkbox-item bg-blue-50 border-blue-300 hover:bg-blue-100">
                                <input id="final-agreement" type="checkbox" required>
                                <div class="ml-3 flex-1">
                                    <span class="text-sm font-bold text-gray-800">Final Confirmation</span>
                                    <p class="text-sm text-gray-700 mt-1 leading-relaxed">
                                        By checking this box, I confirm that all information provided is accurate and I agree to all terms and conditions of this rental agreement.
                                    </p>
                                </div>
                            </label>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Modern Preview Column -->
            <div class="lg:col-span-2 lg:sticky top-8 self-start no-print">
                <div id="preview-area" class="preview-panel overflow-hidden animate-fade-in">
                    <!-- Modern Header Section -->
                    <div class="bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 p-8 text-white relative overflow-hidden">
                        <div class="relative z-10">
                            <h2 class="text-3xl font-bold text-center mb-3 text-white-shadow">Agreement Preview</h2>
                            <p class="text-center text-white/95 text-sm font-medium">Live updates as you fill the form</p>
                            
                            <!-- Modern Progress Indicator -->
                            <div class="mt-6">
                                <div class="flex justify-between text-sm mb-3">
                                    <span class="font-semibold text-white">Form Completion</span>
                                    <span id="progress-percentage" class="font-bold text-white">0%</span>
                                </div>
                                <div class="progress-container">
                                    <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Decorative Elements -->
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
                        <div class="absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full -ml-12 -mb-12"></div>
                    </div>
                    
                    <!-- Content Section with Better Contrast -->
                    <div class="p-8 space-y-8 bg-white">
                        <!-- Agreement Date -->
                        <div class="info-card text-center bg-gray-50 border border-gray-200">
                            <p class="text-gray-800 text-lg font-medium">
                                Agreement Date: <strong class="preview-date text-indigo-600 font-bold"></strong>
                            </p>
                        </div>

                        <!-- Modern Parties Section -->
                        <div class="grid grid-cols-1 gap-6">
                            <div class="info-card bg-gradient-to-r from-blue-50 to-cyan-50 border-l-4 border-blue-500">
                                <h3 class="font-bold text-blue-800 mb-4 flex items-center text-lg">
                                    <span class="mr-3 text-2xl">üè†</span>Landlord
                                </h3>
                                <div class="space-y-3">
                                    <p class="text-sm text-gray-800 flex items-center">
                                        <span class="w-3 h-3 bg-blue-500 rounded-full mr-3 flex-shrink-0"></span>
                                        <strong class="mr-2">Name:</strong> <span>BAIJNATH JAISWAL</span>
                                    </p>
                                    <p class="text-sm text-gray-800 flex items-center">
                                        <span class="w-3 h-3 bg-green-500 rounded-full mr-3 flex-shrink-0"></span>
                                        <strong class="mr-2">Contact:</strong> <span>+971 55 177 1251</span>
                                    </p>
                                </div>
                            </div>
                            
                            <div class="info-card bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-500">
                                <h3 class="font-bold text-green-800 mb-4 flex items-center text-lg">
                                    <span class="mr-3 text-2xl">üë§</span>Tenant
                                </h3>
                                <div class="space-y-3 text-sm">
                                    <p class="text-gray-800"><strong class="mr-2">Name:</strong> <span id="preview-tenant-name" class="font-semibold text-green-700">[Tenant Name]</span></p>
                                    <p class="text-gray-800"><strong class="mr-2">ID:</strong> <span id="preview-tenant-id">[ID Number]</span></p>
                                    <p class="text-gray-800"><strong class="mr-2">Contact:</strong> <span id="preview-tenant-contact">[Contact]</span></p>
                                    <p class="text-gray-800"><strong class="mr-2">Email:</strong> <span id="preview-tenant-email">[Email]</span></p>
                                    <p class="text-gray-800"><strong class="mr-2">Nationality:</strong> <span id="preview-tenant-nationality">[Nationality]</span></p>
                                    <p class="text-gray-800"><strong class="mr-2">Visa:</strong> <span id="preview-tenant-visa">[Visa Status]</span></p>
                                </div>
                            </div>
                        </div>

                        <!-- Property Details -->
                        <div class="info-card bg-gradient-to-r from-purple-50 to-pink-50 border-l-4 border-purple-500">
                            <h3 class="font-bold text-purple-800 mb-4 flex items-center text-lg">
                                <span class="mr-3 text-2xl">üìç</span>Property Details
                            </h3>
                            <div class="space-y-3 text-sm">
                                <p class="text-gray-800"><strong class="mr-2">Location:</strong> <span id="preview-property-location" class="text-purple-700 font-medium">Apartment 820, Nook 1, Jebel Ali Village, Dubai</span></p>
                                <p class="text-gray-800"><strong class="mr-2">Room Type:</strong> <span id="preview-room-type" class="font-semibold">[Room Type]</span></p>
                                <p class="text-gray-800"><strong class="mr-2">Start Date:</strong> <span id="preview-start-date" class="font-semibold">[Start Date]</span></p>
                            </div>
                        </div>

                        <!-- Modern Financial Summary -->
                        <div class="info-card bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 border border-emerald-200 overflow-hidden relative">
                            <div class="absolute top-0 right-0 w-24 h-24 bg-emerald-100 rounded-full -mr-12 -mt-12 opacity-50"></div>
                            <h3 class="font-bold text-emerald-800 mb-4 flex items-center text-lg relative z-10">
                                <span class="mr-3 text-2xl">üí∞</span>Financial Summary
                            </h3>
                            <div class="grid grid-cols-2 gap-4 text-sm relative z-10">
                                <div class="bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-white/50 hover:shadow-lg transition-all">
                                    <p class="text-gray-600 text-xs font-medium uppercase tracking-wide">Monthly Rent</p>
                                    <p class="font-bold text-xl text-emerald-600">AED <span id="preview-monthly-rent">3,200</span></p>
                                </div>
                                <div class="bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-white/50 hover:shadow-lg transition-all">
                                    <p class="text-gray-600 text-xs font-medium uppercase tracking-wide">Additional Charges</p>
                                    <p class="font-bold text-xl text-blue-600">AED <span id="preview-additional-charges">100</span></p>
                                </div>
                                <div class="bg-gradient-to-r from-emerald-100 to-teal-100 p-4 rounded-xl border-2 border-emerald-300 col-span-2 hover:shadow-lg transition-all">
                                    <p class="text-emerald-800 font-bold text-sm uppercase tracking-wide">Total Monthly Payment</p>
                                    <p class="font-bold text-3xl text-emerald-700">AED <span id="preview-total-monthly">3,300</span></p>
                                </div>
                                <div class="bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-white/50 hover:shadow-lg transition-all col-span-2">
                                    <p class="text-gray-600 text-xs font-medium uppercase tracking-wide">Security Deposit</p>
                                    <p class="font-bold text-xl text-orange-600">AED <span id="preview-security-deposit">3,200</span></p>
                                </div>
                            </div>
                        </div>

                        <!-- Modern Inclusions -->
                        <div class="info-card bg-gradient-to-r from-yellow-50 to-amber-50 border-l-4 border-yellow-500">
                            <h3 class="font-bold text-yellow-800 mb-4 flex items-center text-lg">
                                <span class="mr-3 text-2xl">‚ú®</span>Included Services
                            </h3>
                            <div id="preview-inclusions" class="text-sm text-gray-700">
                                <p class="text-gray-500 italic">Select services from the form...</p>
                            </div>
                        </div>

                        <!-- Modern Agreement Status -->
                        <div class="info-card bg-gradient-to-r from-indigo-50 to-blue-50 border-l-4 border-indigo-500">
                            <h3 class="font-bold text-indigo-800 mb-4 flex items-center text-lg">
                                <span class="mr-3 text-2xl">üìã</span>Agreement Status
                            </h3>
                            <div class="space-y-3 text-sm">
                                <div class="status-indicator">
                                    <span id="rules-status-icon" class="text-lg">‚è≥</span>
                                    <span>House Rules: <span id="rules-status" class="font-medium">Pending acknowledgment</span></span>
                                </div>
                                <div class="status-indicator">
                                    <span id="notice-status-icon" class="text-lg">‚è≥</span>
                                    <span>30-Day Notice: <span id="notice-status" class="font-medium">Pending agreement</span></span>
                                </div>
                                <div class="status-indicator">
                                    <span id="final-status-icon" class="text-lg">‚è≥</span>
                                    <span>Final Declaration: <span id="final-status" class="font-medium">Pending confirmation</span></span>
                                </div>
                            </div>
                        </div>

                        <!-- Modern Action Button -->
                        <button id="generate-button" class="btn-generate w-full" disabled>
                            <span id="button-text" class="relative z-10">Complete All Fields to Generate</span>
                            <span id="button-icon" class="ml-3 text-xl relative z-10">üîí</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modern Footer -->
    <footer class="glass-card mt-16 no-print mx-4 lg:mx-8 mb-8">
        <div class="container mx-auto px-8 py-12 text-center">
            <div class="max-w-4xl mx-auto">
                <h3 class="text-2xl font-bold text-white mb-6 text-shadow">Important Legal Notice</h3>
                <div class="text-white/90 space-y-4 text-sm leading-relaxed">
                    <p class="flex items-center justify-center">
                        <span class="mr-2">‚öñÔ∏è</span>
                        This rental agreement is designed for room rentals in Dubai, UAE and complies with local tenancy laws.
                    </p>
                    <p class="flex items-center justify-center">
                        <span class="mr-2">üìÑ</span>
                        Both parties should keep a copy of this agreement for their records.
                    </p>
                    <p class="flex items-center justify-center">
                        <span class="mr-2">üèõÔ∏è</span>
                        For any disputes, UAE tenancy laws and Dubai Rental Dispute Center regulations apply.
                    </p>
                </div>
                <div class="mt-8 pt-6 border-t border-white/20">
                    <p class="text-xs text-white/70">
                        ¬© 2024 Furnished Room Rental Agreement Generator ‚Ä¢ Apartment 820, Nook 1, Jebel Ali Village, Dubai
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- This div is hidden and will be populated for printing -->
    <div id="print-output" style="display: none; position: absolute; top: 0; left: 0; width: 100%; background: white; z-index: 9999;"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('rental-form');
            const generateButton = document.getElementById('generate-button');
            const printOutput = document.getElementById('print-output');
            
            const fields = {
                tenantName: document.getElementById('tenant-name'),
                tenantId: document.getElementById('tenant-id'),
                tenantContact: document.getElementById('tenant-contact'),
                tenantEmail: document.getElementById('tenant-email'),
                tenantNationality: document.getElementById('tenant-nationality'),
                tenantVisaStatus: document.getElementById('tenant-visa-status'),
                propertyLocation: document.getElementById('property-location'),
                roomType: document.getElementById('room-type'),
                contractStartDate: document.getElementById('contract-start-date'),
                monthlyRent: document.getElementById('monthly-rent'),
                securityDeposit: document.getElementById('security-deposit'),
                additionalCharges: document.getElementById('additional-charges'),
                rentInclusions: document.getElementById('rent-inclusions'),
                noticeAgreement: document.getElementById('notice-agreement'),
                finalAgreement: document.getElementById('final-agreement'),
            };

            const previews = {
                date: document.querySelector('.preview-date'),
                tenantName: document.getElementById('preview-tenant-name'),
                tenantId: document.getElementById('preview-tenant-id'),
                tenantContact: document.getElementById('preview-tenant-contact'),
                tenantEmail: document.getElementById('preview-tenant-email'),
                tenantNationality: document.getElementById('preview-tenant-nationality'),
                tenantVisa: document.getElementById('preview-tenant-visa'),
                propertyLocation: document.getElementById('preview-property-location'),
                roomType: document.getElementById('preview-room-type'),
                startDate: document.getElementById('preview-start-date'),
                monthlyRent: document.getElementById('preview-monthly-rent'),
                additionalCharges: document.getElementById('preview-additional-charges'),
                securityDeposit: document.getElementById('preview-security-deposit'),
                totalMonthly: document.getElementById('preview-total-monthly'),
                inclusions: document.getElementById('preview-inclusions'),
                rulesStatus: document.getElementById('rules-status'),
                rulesStatusIcon: document.getElementById('rules-status-icon'),
                noticeStatus: document.getElementById('notice-status'),
                noticeStatusIcon: document.getElementById('notice-status-icon'),
                finalStatus: document.getElementById('final-status'),
                finalStatusIcon: document.getElementById('final-status-icon'),
                progressBar: document.getElementById('progress-bar'),
                progressPercentage: document.getElementById('progress-percentage'),
                buttonText: document.getElementById('button-text'),
                buttonIcon: document.getElementById('button-icon'),
            };

            const houseRules = [
                "I agree to keep noise levels low and will not host loud music or parties, especially during quiet hours (10 PM - 8 AM).",
                "I agree to inform the landlord/coordinator in advance before having any guests over and ensure they follow all house rules.",
                "I agree not to smoke inside the apartment, including my room, the balcony, or any common areas. Smoking is strictly prohibited.",
                "I agree to maintain the cleanliness of my room and all shared common areas including kitchen, bathrooms, and living spaces.",
                "I understand I am responsible for any damages I cause to the property and will bear the cost of repairs immediately.",
                "I acknowledge that common areas are monitored by CCTV for security purposes and consent to this monitoring.",
                "I agree to use shared kitchen appliances respectfully, clean after use, and coordinate with other flatmates.",
                "I agree to respect other tenants' privacy and personal belongings and will not enter other tenants' rooms without permission.",
                "I understand that subletting or allowing unauthorized persons to stay overnight is strictly prohibited.",
                "I agree to follow all UAE laws and regulations and understand that any illegal activities will result in immediate termination.",
                "I agree to keep common areas tidy and will participate in a cleaning rotation schedule if implemented.",
                "I understand that excessive utility usage may result in additional charges, and I will use utilities responsibly."
            ];
            
            const rulesListContainer = document.getElementById('rules-list');
            houseRules.forEach((rule, index) => {
                const ruleId = `rule-${index}`;
                rulesListContainer.innerHTML += `
                    <label class="flex items-start space-x-3 p-4 bg-white/50 rounded-lg border border-white/20 cursor-pointer hover:bg-white/70 hover:border-white/40 transition-all group">
                        <input id="${ruleId}" type="checkbox" class="rule-checkbox mt-1" required>
                        <span class="text-sm text-gray-700 leading-relaxed group-hover:text-gray-800 transition-colors">${rule}</span>
                    </label>`;
            });
            
            const ruleCheckboxes = document.querySelectorAll('.rule-checkbox');

            const formatDate = (dateString) => {
                if (!dateString) return '[Date]';
                try {
                    const date = new Date(dateString + 'T00:00:00'); // Treat as local time
                    if (isNaN(date.getTime())) return '[Invalid Date]';
                    return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
                } catch (error) {
                    console.log('Date formatting error:', error);
                    return '[Date Error]';
                }
            };

            const updatePreview = () => {
                // Update basic information
                previews.date.textContent = formatDate(new Date().toISOString().split('T')[0]);
                
                // Update tenant information
                previews.tenantName.textContent = fields.tenantName?.value || '[Tenant Name]';
                previews.tenantId.textContent = fields.tenantId?.value || '[ID Number]';
                previews.tenantContact.textContent = fields.tenantContact?.value || '[Contact]';
                previews.tenantEmail.textContent = fields.tenantEmail?.value || '[Email]';
                previews.tenantNationality.textContent = fields.tenantNationality?.value || '[Nationality]';
                previews.tenantVisa.textContent = fields.tenantVisaStatus?.value || '[Visa Status]';
                
                // Update property information
                previews.propertyLocation.textContent = fields.propertyLocation?.value || 'Apartment 820, Nook 1, Jebel Ali Village, Dubai';
                previews.roomType.textContent = fields.roomType?.value || '[Room Type]';
                previews.startDate.textContent = formatDate(fields.contractStartDate?.value);
                
                // Update financial information with formatting
                const rent = parseFloat(fields.monthlyRent?.value) || 0;
                const charges = parseFloat(fields.additionalCharges?.value) || 0;
                const deposit = parseFloat(fields.securityDeposit?.value) || 0;
                const total = rent + charges;
                
                previews.monthlyRent.textContent = rent.toLocaleString();
                previews.additionalCharges.textContent = charges.toLocaleString();
                previews.securityDeposit.textContent = deposit.toLocaleString();
                previews.totalMonthly.textContent = total.toLocaleString();
                
                // Update inclusions
                const checkedInclusions = Array.from(fields.rentInclusions?.querySelectorAll('input:checked') || []);
                if (checkedInclusions.length > 0) {
                    const inclusionsList = checkedInclusions.map(cb => 
                        `<div class="flex items-center mb-1"><span class="text-green-500 mr-2">‚úì</span><span>${cb.value}</span></div>`
                    ).join('');
                    previews.inclusions.innerHTML = inclusionsList;
                } else {
                    previews.inclusions.innerHTML = '<p class="text-gray-500 italic">No services selected</p>';
                }
                
                // Update rule status
                const ruleCheckboxes = document.querySelectorAll('.rule-checkbox');
                const checkedRules = Array.from(ruleCheckboxes).filter(cb => cb.checked);
                const rulesProgress = checkedRules.length;
                const totalRules = ruleCheckboxes.length;
                
                if (rulesProgress === totalRules && totalRules > 0) {
                    previews.rulesStatus.textContent = `All ${totalRules} rules acknowledged`;
                    previews.rulesStatus.className = 'font-medium text-green-600';
                    previews.rulesStatusIcon.textContent = '‚úÖ';
                } else if (rulesProgress > 0) {
                    previews.rulesStatus.textContent = `${rulesProgress}/${totalRules} rules acknowledged`;
                    previews.rulesStatus.className = 'font-medium text-yellow-600';
                    previews.rulesStatusIcon.textContent = '‚è≥';
                } else {
                    previews.rulesStatus.textContent = 'Pending acknowledgment';
                    previews.rulesStatus.className = 'font-medium text-gray-600';
                    previews.rulesStatusIcon.textContent = '‚è≥';
                }
                
                // Update notice agreement status
                if (fields.noticeAgreement?.checked) {
                    previews.noticeStatus.textContent = 'Agreed to 30-day notice';
                    previews.noticeStatus.className = 'font-medium text-green-600';
                    previews.noticeStatusIcon.textContent = '‚úÖ';
                } else {
                    previews.noticeStatus.textContent = 'Pending agreement';
                    previews.noticeStatus.className = 'font-medium text-gray-600';
                    previews.noticeStatusIcon.textContent = '‚è≥';
                }
                
                // Update final agreement status
                if (fields.finalAgreement?.checked) {
                    previews.finalStatus.textContent = 'Final declaration confirmed';
                    previews.finalStatus.className = 'font-medium text-green-600';
                    previews.finalStatusIcon.textContent = '‚úÖ';
                } else {
                    previews.finalStatus.textContent = 'Pending confirmation';
                    previews.finalStatus.className = 'font-medium text-gray-600';
                    previews.finalStatusIcon.textContent = '‚è≥';
                }
                
                // Calculate and update progress
                updateProgressBar();
            };
            
            const updateProgressBar = () => {
                const requiredFields = [
                    fields.tenantName,
                    fields.tenantId,
                    fields.tenantContact,
                    fields.tenantEmail,
                    fields.tenantNationality,
                    fields.tenantVisaStatus,
                    fields.roomType,
                    fields.contractStartDate,
                    fields.monthlyRent,
                    fields.securityDeposit,
                    fields.additionalCharges,
                ];
                
                let filledFields = 0;
                requiredFields.forEach(field => {
                    if (field && field.value && field.value.trim() !== '') {
                        filledFields++;
                    }
                });
                
                // Add rule checkboxes to progress
                const ruleCheckboxes = document.querySelectorAll('.rule-checkbox');
                const checkedRules = Array.from(ruleCheckboxes).filter(cb => cb.checked).length;
                const totalRules = ruleCheckboxes.length;
                
                // Add final agreements
                const noticeAgreed = fields.noticeAgreement?.checked ? 1 : 0;
                const finalAgreed = fields.finalAgreement?.checked ? 1 : 0;
                
                // Calculate total progress
                const totalRequiredItems = requiredFields.length + 1 + 1 + 1; // fields + rules + notice + final
                const completedItems = filledFields + (checkedRules === totalRules && totalRules > 0 ? 1 : 0) + noticeAgreed + finalAgreed;
                
                const progressPercentage = Math.round((completedItems / totalRequiredItems) * 100);
                
                // Update progress bar
                previews.progressBar.style.width = `${progressPercentage}%`;
                previews.progressPercentage.textContent = `${progressPercentage}%`;
                
                // Update progress bar color based on completion
                if (progressPercentage === 100) {
                    previews.progressBar.className = 'bg-green-400 h-2 rounded-full transition-all duration-500';
                } else if (progressPercentage >= 75) {
                    previews.progressBar.className = 'bg-yellow-400 h-2 rounded-full transition-all duration-500';
                } else {
                    previews.progressBar.className = 'bg-white h-2 rounded-full transition-all duration-500';
                }
            };
            
            const validateForm = () => {
                let isValid = form.checkValidity();
                
                // Check if all rule checkboxes are checked
                const ruleCheckboxes = document.querySelectorAll('.rule-checkbox');
                const allRulesChecked = Array.from(ruleCheckboxes).every(cb => cb.checked);
                
                isValid = isValid && allRulesChecked;
                
                if (isValid) {
                    generateButton.disabled = false;
                    previews.buttonText.textContent = 'Generate & Print Agreement';
                    previews.buttonIcon.textContent = 'üöÄ';
                    generateButton.classList.remove('bg-indigo-300', 'cursor-not-allowed');
                    generateButton.classList.add('bg-gradient-to-r', 'from-indigo-600', 'to-purple-600', 'hover:from-indigo-700', 'hover:to-purple-700');
                    generateButton.style.background = 'var(--primary-gradient)';
                } else {
                    generateButton.disabled = true;
                    previews.buttonText.textContent = 'Complete All Fields to Generate';
                    previews.buttonIcon.textContent = 'üîí';
                    generateButton.classList.add('cursor-not-allowed');
                    generateButton.classList.remove('bg-gradient-to-r', 'from-indigo-600', 'to-purple-600', 'hover:from-indigo-700', 'hover:to-purple-700');
                    generateButton.style.background = 'linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%)';
                }
            };

            const generatePrintableAgreement = () => {
                // Debug logging
                console.log('Generating printable agreement...');
                console.log('Fields:', fields);
                
                const rent = parseFloat(fields.monthlyRent?.value) || 0;
                const charges = parseFloat(fields.additionalCharges?.value) || 0;
                const total = rent + charges;
                const includedItems = Array.from(fields.rentInclusions?.querySelectorAll('input:checked') || []).map(cb => `<div style="display: flex; align-items: center; margin-bottom: 0.3rem;"><span style="color: #10B981; margin-right: 0.5rem; font-weight: bold;">‚úì</span><span>${cb.value}</span></div>`).join('');
                const agreedRules = houseRules.map((rule, index) => `<div style="display: flex; margin-bottom: 0.5rem;"><span style="color: #6366F1; margin-right: 0.5rem; font-weight: bold; min-width: 1.5rem;">${index + 1}.</span><span>${rule.replace('I agree to ', '').replace('I understand ', '').replace('I acknowledge that ', '')}</span></div>`).join('');

                // Ensure we have values
                const tenantName = fields.tenantName?.value || 'N/A';
                const tenantId = fields.tenantId?.value || 'N/A';
                const tenantNationality = fields.tenantNationality?.value || 'N/A';
                const tenantVisaStatus = fields.tenantVisaStatus?.value || 'N/A';
                const tenantContact = fields.tenantContact?.value || 'N/A';
                const tenantEmail = fields.tenantEmail?.value || 'N/A';
                const roomType = fields.roomType?.value || 'N/A';
                const propertyLocation = fields.propertyLocation?.value || 'Apartment 820, Nook 1, Jebel Ali Village, Dubai';
                const contractStartDate = fields.contractStartDate?.value || '';
                const securityDeposit = parseFloat(fields.securityDeposit?.value) || 0;

                console.log('Data prepared for printing:', {
                    tenantName, tenantId, roomType, total, securityDeposit
                });

                const content = `
                    <div style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 100%; margin: 0; background: white; color: #1F2937; line-height: 1.4; font-size: 10pt;">
                        
                        <!-- Page 1: Header and Basic Info -->
                        <div class="keep-together" style="min-height: 40vh;">
                            <!-- Header Section -->
                            <div style="background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%); padding: 1.5rem; text-align: center; margin-bottom: 1.5rem; border-radius: 0;">
                                <h1 style="color: white; font-size: 2rem; font-weight: 700; margin: 0; letter-spacing: -0.02em;">Furnished Room Rental Agreement</h1>
                                <div style="background: rgba(255,255,255,0.2); padding: 0.5rem 1rem; border-radius: 25px; display: inline-block; margin-top: 0.75rem;">
                                    <p style="color: white; margin: 0; font-weight: 500; font-size: 0.9rem;">Agreement Date: ${formatDate(new Date().toISOString().split('T')[0])}</p>
                                </div>
                            </div>

                            <!-- Property Information Card -->
                            <div class="keep-together" style="background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #6366F1;">
                                <h3 style="color: #374151; font-size: 1rem; font-weight: 600; margin: 0 0 0.25rem 0;">üìç Property Location</h3>
                                <p style="color: #6B7280; margin: 0; font-size: 0.95rem; font-weight: 500;">${propertyLocation}</p>
                                <p style="color: #6366F1; margin: 0.25rem 0 0 0; font-weight: 600; font-size: 0.9rem;">${roomType}</p>
                            </div>

                            <!-- Parties Section -->
                            <div class="keep-together" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                                <div style="background: #F8FAFC; padding: 1rem; border-radius: 8px; border: 1px solid #E2E8F0;">
                                    <h3 style="color: #1E293B; font-size: 0.95rem; font-weight: 600; margin: 0 0 0.75rem 0; display: flex; align-items: center;"><span style="margin-right: 0.5rem;">üè†</span>Landlord</h3>
                                    <div>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Name:</strong> BAIJNATH JAISWAL</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Contact:</strong> +971 55 177 1251</p>
                                    </div>
                                </div>
                                <div style="background: #F8FAFC; padding: 1rem; border-radius: 8px; border: 1px solid #E2E8F0;">
                                    <h3 style="color: #1E293B; font-size: 0.95rem; font-weight: 600; margin: 0 0 0.75rem 0; display: flex; align-items: center;"><span style="margin-right: 0.5rem;">üë§</span>Tenant</h3>
                                    <div>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Name:</strong> ${tenantName}</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>ID:</strong> ${tenantId}</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Nationality:</strong> ${tenantNationality}</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Visa:</strong> ${tenantVisaStatus}</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Contact:</strong> ${tenantContact}</p>
                                        <p style="margin: 0.2rem 0; color: #475569; font-size: 0.85rem;"><strong>Email:</strong> ${tenantEmail}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Financial Summary Card -->
                        <div class="keep-together" style="background: linear-gradient(135deg, #10B981 0%, #059669 100%); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; color: white;">
                            <h3 style="color: white; font-size: 1.1rem; font-weight: 600; margin: 0 0 0.75rem 0; display: flex; align-items: center;"><span style="margin-right: 0.5rem;">üí∞</span>Financial Summary</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                                <div style="background: rgba(255,255,255,0.2); padding: 0.75rem; border-radius: 6px;">
                                    <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Monthly Rent</p>
                                    <p style="margin: 0; font-size: 1.2rem; font-weight: 700;">AED ${rent.toFixed(2)}</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 0.75rem; border-radius: 6px;">
                                    <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Additional Charges</p>
                                    <p style="margin: 0; font-size: 1.2rem; font-weight: 700;">AED ${charges.toFixed(2)}</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.3); padding: 0.75rem; border-radius: 6px; border: 2px solid rgba(255,255,255,0.5);">
                                    <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Total Monthly</p>
                                    <p style="margin: 0; font-size: 1.2rem; font-weight: 700;">AED ${total.toFixed(2)}</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 0.75rem; border-radius: 6px;">
                                    <p style="margin: 0; font-size: 0.8rem; opacity: 0.9;">Security Deposit</p>
                                    <p style="margin: 0; font-size: 1.2rem; font-weight: 700;">AED ${securityDeposit.toFixed(2)}</p>
                                </div>
                            </div>
                            <div style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(255,255,255,0.3);">
                                <p style="margin: 0 0 0.5rem 0; font-weight: 600; font-size: 0.9rem;">‚ú® Included Services:</p>
                                <div style="margin-left: 0.5rem; font-size: 0.85rem;">${includedItems}</div>
                            </div>
                        </div>

                        <!-- Page Break Before Terms -->
                        <div class="page-break-before"></div>

                        <!-- Page 2: Terms Section -->
                        <div style="margin-bottom: 1.5rem;">
                            <h3 style="color: #1E293B; font-size: 1.1rem; font-weight: 600; margin: 0 0 0.75rem 0; padding-bottom: 0.25rem; border-bottom: 2px solid #E2E8F0;">üìã Agreement Terms</h3>
                            
                            <div class="keep-together" style="background: #FFFBEB; border-left: 4px solid #F59E0B; padding: 1rem; border-radius: 0 6px 6px 0; margin-bottom: 1rem;">
                                <h4 style="color: #92400E; margin: 0 0 0.25rem 0; font-weight: 600; font-size: 0.9rem;">üè† Property & Tenancy</h4>
                                <p style="color: #78350F; margin: 0; font-size: 0.85rem;">This agreement commences on <strong>${formatDate(contractStartDate)}</strong> for the rental of a ${roomType} with access to shared common areas. The tenancy is month-to-month and renewable upon mutual agreement.</p>
                            </div>

                            <div class="keep-together" style="background: #EFF6FF; border-left: 4px solid #3B82F6; padding: 1rem; border-radius: 0 6px 6px 0; margin-bottom: 1rem;">
                                <h4 style="color: #1E40AF; margin: 0 0 0.25rem 0; font-weight: 600; font-size: 0.9rem;">üí≥ Payment Terms</h4>
                                <p style="color: #1E3A8A; margin: 0; font-size: 0.85rem;">Monthly payment of <strong>AED ${total.toFixed(2)}</strong> is due on the 1st of each month. Security deposit is refundable within 30 days after tenancy termination, subject to property condition assessment.</p>
                            </div>

                            <div class="keep-together" style="background: #F0F9FF; border-left: 4px solid #0EA5E9; padding: 1rem; border-radius: 0 6px 6px 0; margin-bottom: 1rem;">
                                <h4 style="color: #0C4A6E; margin: 0 0 0.25rem 0; font-weight: 600; font-size: 0.9rem;">‚è∞ Notice Period</h4>
                                <p style="color: #075985; margin: 0; font-size: 0.85rem;">Either party must provide <strong>30 days written notice</strong> before termination. Failure to provide adequate notice may result in forfeiture of deposit equivalent to one month's rent.</p>
                            </div>
                        </div>

                        <!-- House Rules -->
                        <div class="keep-together" style="margin-bottom: 1.5rem;">
                            <h3 style="color: #1E293B; font-size: 1.1rem; font-weight: 600; margin: 0 0 0.75rem 0; padding-bottom: 0.25rem; border-bottom: 2px solid #E2E8F0;">üè° House Rules & Conditions</h3>
                            <div style="background: #FAFAFA; padding: 1rem; border-radius: 8px; border: 1px solid #E5E7EB;">
                                <p style="color: #6B7280; margin: 0 0 0.75rem 0; font-style: italic; font-size: 0.85rem;">The tenant acknowledges and agrees to comply with the following house rules:</p>
                                <div style="margin-left: 0; font-size: 0.8rem;">${agreedRules}</div>
                            </div>
                        </div>

                        <!-- Page Break Before Legal -->
                        <div class="page-break-before"></div>

                        <!-- Page 3: Legal and Signatures -->
                        <!-- Legal Compliance -->
                        <div class="keep-together" style="background: #F1F5F9; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border: 1px solid #CBD5E1;">
                            <h3 style="color: #334155; font-size: 0.95rem; font-weight: 600; margin: 0 0 0.5rem 0;">‚öñÔ∏è Legal Compliance</h3>
                            <p style="color: #64748B; margin: 0; font-size: 0.8rem;">This digital agreement complies with UAE Electronic Transactions Law and Dubai tenancy regulations. Both parties acknowledge this constitutes a legally binding agreement completed on ${formatDate(new Date().toISOString().split('T')[0])} at ${new Date().toLocaleTimeString()}.</p>
                        </div>

                        <!-- Additional Terms -->
                        <div class="keep-together" style="margin-bottom: 2rem;">
                            <h3 style="color: #1E293B; font-size: 1rem; font-weight: 600; margin: 0 0 0.75rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #E2E8F0;">üìù Additional Terms</h3>
                            <div style="font-size: 0.8rem; line-height: 1.3;">
                                <p style="margin: 0.5rem 0; color: #374151;"><strong>Maintenance:</strong> Minor maintenance issues should be reported immediately. Major repairs will be handled by the landlord.</p>
                                <p style="margin: 0.5rem 0; color: #374151;"><strong>Keys & Access:</strong> Tenant will receive one set of keys. Lost keys will be replaced at tenant's expense (AED 200).</p>
                                <p style="margin: 0.5rem 0; color: #374151;"><strong>Insurance:</strong> Tenant is advised to obtain personal contents insurance. Landlord is not liable for personal belongings.</p>
                                <p style="margin: 0.5rem 0; color: #374151;"><strong>Compliance:</strong> This agreement complies with UAE tenancy laws and Dubai Municipality regulations.</p>
                            </div>
                        </div>

                        <!-- Signature Section -->
                        <div class="keep-together" style="background: linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h3 style="color: #1E293B; font-size: 1rem; font-weight: 600; margin: 0 0 1.5rem 0; text-align: center;">‚úçÔ∏è Digital Signatures</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <div style="text-align: center;">
                                    <div style="border-top: 2px solid #374151; padding-top: 0.75rem; margin-bottom: 0.5rem;">
                                        <p style="margin: 0; font-weight: 600; color: #374151; font-size: 0.9rem;">Landlord/Coordinator</p>
                                        <p style="margin: 0.25rem 0; color: #6B7280; font-size: 0.85rem;">BAIJNATH JAISWAL</p>
                                    </div>
                                    <p style="margin: 0.75rem 0 0 0; color: #9CA3AF; font-size: 0.8rem;">Date: _______________</p>
                                </div>
                                <div style="text-align: center;">
                                    <div style="border-top: 2px solid #374151; padding-top: 0.75rem; margin-bottom: 0.5rem;">
                                        <p style="margin: 0; font-weight: 600; color: #374151; font-size: 0.9rem;">Tenant</p>
                                        <p style="margin: 0.25rem 0; color: #6B7280; font-size: 0.85rem;">${tenantName}</p>
                                    </div>
                                    <p style="margin: 0.75rem 0 0 0; color: #9CA3AF; font-size: 0.8rem;">Date: _______________</p>
                                </div>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div style="background: #1F2937; color: white; text-align: center; padding: 1rem; margin-top: 1rem;">
                            <p style="margin: 0; font-size: 0.8rem; opacity: 0.8;">Furnished Room Rental Agreement ‚Ä¢ Apartment 820, Nook 1, Jebel Ali Village, Dubai</p>
                        </div>
                    </div>
                `;
                printOutput.innerHTML = content;
                console.log('Print content generated:', content.substring(0, 200) + '...');
            };

            form.addEventListener('input', () => {
                updatePreview();
                validateForm();
                
                // Add animation to preview panel when data changes
                const previewArea = document.getElementById('preview-area');
                previewArea.classList.add('animate-slide-in');
                setTimeout(() => {
                    previewArea.classList.remove('animate-slide-in');
                }, 500);
            });
            
            form.addEventListener('change', () => {
                updatePreview();
                validateForm();
            });
            
            // Add real-time formatting for number inputs
            fields.monthlyRent.addEventListener('input', (e) => {
                const value = parseInt(e.target.value) || 0;
                if (value > 0) {
                    previews.monthlyRent.textContent = value.toLocaleString();
                }
            });
            
            fields.additionalCharges.addEventListener('input', (e) => {
                const value = parseInt(e.target.value) || 0;
                previews.additionalCharges.textContent = value.toLocaleString();
            });
            
            fields.securityDeposit.addEventListener('input', (e) => {
                const value = parseInt(e.target.value) || 0;
                if (value > 0) {
                    previews.securityDeposit.textContent = value.toLocaleString();
                }
            });
            
            // Add status change animations
            const observeStatusChanges = () => {
                const statusElements = [
                    previews.rulesStatusIcon,
                    previews.noticeStatusIcon,
                    previews.finalStatusIcon
                ];
                
                statusElements.forEach(element => {
                    const observer = new MutationObserver((mutations) => {
                        mutations.forEach((mutation) => {
                            if (mutation.type === 'childList' || mutation.type === 'characterData') {
                                if (element.textContent === '‚úÖ') {
                                    element.classList.add('status-check');
                                    setTimeout(() => {
                                        element.classList.remove('status-check');
                                    }, 600);
                                }
                            }
                        });
                    });
                    
                    observer.observe(element, {
                        childList: true,
                        characterData: true,
                        subtree: true
                    });
                });
            };
            
            // Enhanced error handling and user feedback
            const addFieldValidationFeedback = () => {
                const requiredFields = [
                    fields.tenantName,
                    fields.tenantId,
                    fields.tenantContact,
                    fields.tenantEmail,
                    fields.tenantNationality,
                    fields.tenantVisaStatus,
                    fields.roomType,
                    fields.contractStartDate,
                ];
                
                requiredFields.forEach(field => {
                    if (field) {
                        field.addEventListener('blur', () => {
                            if (field.required && !field.value.trim()) {
                                field.classList.add('border-red-500', 'bg-red-50');
                                setTimeout(() => {
                                    field.classList.remove('border-red-500', 'bg-red-50');
                                }, 2000);
                            }
                        });
                        
                        field.addEventListener('focus', () => {
                            field.classList.remove('border-red-500', 'bg-red-50');
                        });
                    }
                });
            };

            generateButton.addEventListener('click', () => {
                if (!form.checkValidity()) {
                    form.reportValidity();
                    showNotification('Please fill in all required fields.', 'error');
                    return;
                }
                
                console.log('Generate button clicked');
                generatePrintableAgreement();
                
                // Show the print output temporarily to verify content
                printOutput.style.display = 'block';
                printOutput.style.visibility = 'visible';
                
                showNotification('Agreement generated successfully! Print dialog will open automatically.', 'success');
                
                setTimeout(() => {
                    console.log('Opening print dialog...');
                    window.print();
                    
                    // Hide again after printing
                    setTimeout(() => {
                        printOutput.style.display = 'none';
                    }, 100);
                }, 1000);
            });

            // Modern notification function
            const showNotification = (message, type) => {
                const notification = document.getElementById('notification');
                const notificationText = document.getElementById('notification-text');
                
                notificationText.textContent = message;
                
                if (type === 'success') {
                    notification.className = 'notification p-6 rounded-xl bg-green-100/90 text-green-800 border border-green-200/50 backdrop-blur-sm animate-fade-in';
                } else {
                    notification.className = 'notification p-6 rounded-xl bg-red-100/90 text-red-800 border border-red-200/50 backdrop-blur-sm animate-fade-in';
                }
                
                notification.classList.remove('hidden');
                
                setTimeout(() => {
                    notification.classList.add('hidden');
                }, 5000);
            };

            // Initial calls
            console.log('Initializing enhanced form...');
            updatePreview();
            validateForm();
            observeStatusChanges();
            addFieldValidationFeedback();

            // Force update preview after a short delay to ensure DOM is ready
            setTimeout(() => {
                console.log('Force updating preview...');
                updatePreview();
                validateForm();
            }, 100);
        });
    </script>

</body>
</html>
